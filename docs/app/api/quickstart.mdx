# Quick Start

Get started with FetanPay API in minutes. This guide will walk you through verifying your first payment.

## Prerequisites

- A FetanPay merchant account
- An API key from the [merchant dashboard](https://admin.fetanpay.et/api-keys)
- A server or application that can make HTTP requests

## Step 1: Get Your API Key

<Steps>
  <Steps.Step>
    Log in to your [merchant dashboard](https://admin.fetanpay.et)
  </Steps.Step>
  <Steps.Step>
    Navigate to **API Keys** in the sidebar
  </Steps.Step>
  <Steps.Step>
    Generate a new API key or copy an existing one
  </Steps.Step>
  <Steps.Step>
    **Store it securely** - you won't see it again!
  </Steps.Step>
</Steps>

<Callout type="warning">
  **Security:** Keep your API key secret. Never expose it in client-side code or commit it to version control. Store it in environment variables.
</Callout>

## Step 2: Verify Your First Payment

You'll need:
- **Provider**: The bank (CBE, BOA, Awash, Telebirr, Dashen)
- **Reference**: Transaction reference from the bank receipt
- **Amount**: The amount that was paid

### Example Request

```bash
curl -X POST https://api.fetanpay.et/api/v1/payments/verify \
  -H "Authorization: Bearer YOUR_API_KEY" \
  -H "Content-Type: application/json" \
  -d '{
    "provider": "CBE",
    "reference": "FT26017MLDG7755415774",
    "claimedAmount": 1000.00
  }'
```

### Example Response

**Success (Verified):**

```json
{
  "success": true,
  "status": "VERIFIED",
  "transaction": {
    "id": "txn_1234567890",
    "reference": "FT26017MLDG7755415774",
    "provider": "CBE",
    "amount": 1000.00,
    "status": "VERIFIED",
    "verifiedAt": "2025-01-15T10:30:00Z"
  },
  "checks": {
    "referenceExists": true,
    "amountMatches": true,
    "receiverMatches": true,
    "notDuplicate": true
  }
}
```

**Failed (Unverified):**

```json
{
  "success": false,
  "status": "UNVERIFIED",
  "mismatchReason": "Amount mismatch. Expected: 1000.00 ETB, Found: 500.00 ETB"
}
```

## Step 3: Code Examples

### JavaScript/Node.js

```javascript
async function verifyPayment(reference, amount, provider) {
  const response = await fetch('https://api.fetanpay.et/api/v1/payments/verify', {
    method: 'POST',
    headers: {
      'Authorization': `Bearer ${process.env.FETANPAY_API_KEY}`,
      'Content-Type': 'application/json'
    },
    body: JSON.stringify({
      provider: provider,
      reference: reference,
      claimedAmount: amount
    })
  });

  const result = await response.json();
  
  if (result.status === 'VERIFIED') {
    console.log('✅ Payment verified!');
    return result.transaction;
  } else {
    throw new Error(result.mismatchReason);
  }
}

// Usage
verifyPayment('FT26017MLDG7755415774', 1000.00, 'CBE')
  .then(transaction => {
    updateOrderStatus(transaction.id, 'PAID');
  })
  .catch(error => {
    console.error('Verification failed:', error);
  });
```

### Python

```python
import requests
import os

def verify_payment(reference, amount, provider):
    url = 'https://api.fetanpay.et/api/v1/payments/verify'
    headers = {
        'Authorization': f'Bearer {os.getenv("FETANPAY_API_KEY")}',
        'Content-Type': 'application/json'
    }
    data = {
        'provider': provider,
        'reference': reference,
        'claimedAmount': amount
    }
    
    response = requests.post(url, headers=headers, json=data)
    result = response.json()
    
    if result['status'] == 'VERIFIED':
        print('✅ Payment verified!')
        return result['transaction']
    else:
        raise Exception(result.get('mismatchReason'))

# Usage
try:
    transaction = verify_payment('FT26017MLDG7755415774', 1000.00, 'CBE')
    update_order_status(transaction['id'], 'PAID')
except Exception as e:
    print(f'Error: {e}')
```

## Step 4: Set Up Webhooks (Optional)

For real-time notifications, set up webhooks:

<Steps>
  <Steps.Step>
    Go to [Webhooks](https://admin.fetanpay.et/webhooks) in your dashboard
  </Steps.Step>
  <Steps.Step>
    Enter your webhook URL (must be HTTPS)
  </Steps.Step>
  <Steps.Step>
    Select events: `payment.verified`, `payment.unverified`
  </Steps.Step>
  <Steps.Step>
    Copy the webhook secret
  </Steps.Step>
</Steps>

### Webhook Handler Example

```javascript
const express = require('express');
const crypto = require('crypto');
const app = express();

app.use(express.json());

function verifySignature(payload, signature, secret) {
  const payloadString = JSON.stringify(payload);
  const expectedSignature = crypto
    .createHmac('sha256', secret)
    .update(payloadString)
    .digest('hex');
  
  return crypto.timingSafeEqual(
    Buffer.from(signature),
    Buffer.from(expectedSignature)
  );
}

app.post('/webhooks/fetanpay', (req, res) => {
  const signature = req.headers['x-fetanpay-signature'];
  const secret = process.env.WEBHOOK_SECRET;
  
  if (!verifySignature(req.body, signature, secret)) {
    return res.status(401).send('Invalid signature');
  }
  
  const event = req.body;
  
  if (event.type === 'payment.verified') {
    console.log('Payment verified:', event.data.payment.reference);
    // Update order status
    // Send confirmation email
  }
  
  res.status(200).send('OK');
});

app.listen(3000);
```

## Next Steps

- Read the [API Overview](/api/overview) for detailed information
- Learn about [Authentication](/api/authentication)
- Explore the [Payments API](/api/payments) for all endpoints
- Set up [Webhooks](/api/webhooks) for real-time notifications
