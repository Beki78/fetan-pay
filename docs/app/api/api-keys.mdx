# API Keys Management

Manage your API keys programmatically through the API Keys endpoints.

## Overview

API keys are used to authenticate requests to the FetanPay API. Each merchant account can have multiple API keys for different environments or applications.

## Create API Key

Generate a new API key for your account.

### Endpoint

```http
POST /api/v1/api-keys
```

### Request Body

| Field | Type | Required | Description |
|-------|------|----------|-------------|
| `name` | `string` | Yes | Friendly name for the key (e.g., "Production Key", "Test Key") |
| `expiresAt` | `string` | No | Expiration date in ISO 8601 format |
| `scopes` | `string[]` | No | API key scopes/permissions. Defaults to `["payments:verify", "payments:read"]` |

### Example Request

```bash
curl -X POST https://api.fetanpay.et/api/v1/api-keys \
  -H "Authorization: Bearer YOUR_API_KEY" \
  -H "Content-Type: application/json" \
  -d '{
    "name": "Production API Key",
    "scopes": ["payments:verify", "payments:read"]
  }'
```

### Example Response

```json
{
  "id": "key_1234567890",
  "name": "Production API Key",
  "key": "fetan_live_sk_abc123def456ghi789jkl012mno345pqr678stu901vwx234yz5678901234567890",
  "keyPrefix": "fetan_live_",
  "status": "ACTIVE",
  "expiresAt": null,
  "scopes": ["payments:verify", "payments:read"],
  "createdAt": "2025-01-15T10:30:00Z",
  "warning": "Store this key securely. It will not be shown again."
}
```

<div style={{backgroundColor: '#fef3c7', border: '1px solid #fbbf24', padding: '1rem', borderRadius: '0.5rem', marginBottom: '1.5rem'}}>

**Warning:** The full API key (`key` field) is only returned once on creation. Store it securely immediately. You won't be able to see it again - only the prefix will be shown in subsequent requests.

</div>

## List API Keys

Get all API keys for your account.

### Endpoint

```http
GET /api/v1/api-keys
```

### Example Request

```bash
curl https://api.fetanpay.et/api/v1/api-keys \
  -H "Authorization: Bearer YOUR_API_KEY"
```

### Example Response

```json
[
  {
    "id": "key_1234567890",
    "name": "Production API Key",
    "keyPrefix": "fetan_live_",
    "status": "ACTIVE",
    "lastUsedAt": "2025-01-15T10:30:00Z",
    "createdAt": "2025-01-15T09:00:00Z",
    "expiresAt": null,
    "scopes": ["payments:verify", "payments:read"]
  }
]
```

## Get API Key Details

Get details for a specific API key.

### Endpoint

```http
GET /api/v1/api-keys/:id
```

### Example Request

```bash
curl https://api.fetanpay.et/api/v1/api-keys/key_1234567890 \
  -H "Authorization: Bearer YOUR_API_KEY"
```

## Revoke API Key

Revoke an API key, making it unusable for future requests.

### Endpoint

```http
DELETE /api/v1/api-keys/:id
```

### Example Request

```bash
curl -X DELETE https://api.fetanpay.et/api/v1/api-keys/key_1234567890 \
  -H "Authorization: Bearer YOUR_API_KEY"
```

### Example Response

```json
{
  "message": "API key revoked successfully"
}
```

<div style={{backgroundColor: '#fee2e2', border: '1px solid #f87171', padding: '1rem', borderRadius: '0.5rem', marginBottom: '1.5rem'}}>

**Warning:** Revoking an API key is permanent and cannot be undone. Any applications using this key will stop working immediately.

</div>

## Code Examples

### JavaScript/Node.js

```javascript
async function createApiKey(name) {
  const response = await fetch('https://api.fetanpay.et/api/v1/api-keys', {
    method: 'POST',
    headers: {
      'Authorization': `Bearer ${process.env.FETANPAY_API_KEY}`,
      'Content-Type': 'application/json'
    },
    body: JSON.stringify({ name })
  });
  
  const result = await response.json();
  
  // Store the key immediately - it's only shown once!
  console.log('New API Key:', result.key);
  saveApiKeySecurely(result.key);
  
  return result;
}
```

### Python

```python
import requests
import os

def create_api_key(name):
    url = 'https://api.fetanpay.et/api/v1/api-keys'
    headers = {
        'Authorization': f'Bearer {os.getenv("FETANPAY_API_KEY")}',
        'Content-Type': 'application/json'
    }
    data = {'name': name}
    
    response = requests.post(url, headers=headers, json=data)
    result = response.json()
    
    # Store the key immediately - it's only shown once!
    print(f'New API Key: {result["key"]}')
    save_api_key_securely(result['key'])
    
    return result
```

## Best Practices

### 1. Use Descriptive Names

Name your API keys clearly:
- `Production - Main Application`
- `Production - Background Jobs`
- `Development - Local Testing`

### 2. Set Expiration Dates

For temporary keys, set an expiration date:

```json
{
  "name": "Temporary Integration Key",
  "expiresAt": "2025-12-31T23:59:59Z"
}
```

### 3. Rotate Keys Regularly

- Regenerate keys periodically (e.g., every 90 days)
- Create new key before revoking old one
- Update all applications with new key
- Revoke old key after migration

### 4. Monitor Key Usage

Check `lastUsedAt` to identify unused keys that can be revoked.

## Security

- **Never commit API keys to version control** - Use `.gitignore` for `.env` files
- **Use environment variables** - Store keys in environment variables, not in code
- **Rotate immediately if compromised** - If a key is exposed, revoke it immediately
- **Use HTTPS** - Always use HTTPS for API requests

## Next Steps

- Learn about [Authentication](/api/authentication)
- Explore the [Payments API](/api/payments)
- Set up [Webhooks](/api/webhooks)
