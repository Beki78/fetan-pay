# Authentication

All API requests require authentication using an API key. This guide explains how to get and use your API keys.

## Getting Your API Key

<Steps>
  <Steps.Step>
    Log in to your [merchant dashboard](https://admin.fetanpay.et)
  </Steps.Step>
  <Steps.Step>
    Navigate to **API Keys** in the sidebar
  </Steps.Step>
  <Steps.Step>
    Generate a new API key or copy an existing one
  </Steps.Step>
  <Steps.Step>
    **Copy the key immediately** - it's only shown once!
  </Steps.Step>
</Steps>

<Callout type="warning">
  **Security:** Store your API key securely. If you lose it, you'll need to regenerate a new one. The old key will stop working immediately.
</Callout>

## API Key Format

API keys follow this format:

```
fetan_live_sk_<64_random_characters>
```

Example:
```
fetan_live_sk_abc123def456ghi789jkl012mno345pqr678stu901vwx234yz5678901234567890
```

The prefix `fetan_live_` (first 20 characters) is used for display purposes in the dashboard. The full key is required for API authentication.

## Using Your API Key

Include your API key in the `Authorization` header using the `Bearer` scheme:

```http
Authorization: Bearer YOUR_API_KEY
```

### Example Request

```bash
curl https://api.fetanpay.et/api/v1/payments/verify \
  -H "Authorization: Bearer fetan_live_sk_abc123..." \
  -H "Content-Type: application/json" \
  -d '{
    "provider": "CBE",
    "reference": "FT26017MLDG7755415774",
    "claimedAmount": 1000.00
  }'
```

### JavaScript Example

```javascript
const response = await fetch('https://api.fetanpay.et/api/v1/payments/verify', {
  method: 'POST',
  headers: {
    'Authorization': `Bearer ${process.env.FETANPAY_API_KEY}`,
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    provider: 'CBE',
    reference: 'FT26017MLDG7755415774',
    claimedAmount: 1000.00
  })
});
```

### Python Example

```python
import requests
import os

headers = {
    'Authorization': f'Bearer {os.getenv("FETANPAY_API_KEY")}',
    'Content-Type': 'application/json'
}

data = {
    'provider': 'CBE',
    'reference': 'FT26017MLDG7755415774',
    'claimedAmount': 1000.00
}

response = requests.post(
    'https://api.fetanpay.et/api/v1/payments/verify',
    headers=headers,
    json=data
)
```

### PHP Example

```php
<?php

$ch = curl_init('https://api.fetanpay.et/api/v1/payments/verify');

curl_setopt_array($ch, [
    CURLOPT_RETURNTRANSFER => true,
    CURLOPT_POST => true,
    CURLOPT_HTTPHEADER => [
        'Authorization: Bearer ' . getenv('FETANPAY_API_KEY'),
        'Content-Type: application/json'
    ],
    CURLOPT_POSTFIELDS => json_encode([
        'provider' => 'CBE',
        'reference' => 'FT26017MLDG7755415774',
        'claimedAmount' => 1000.00
    ])
]);

$response = curl_exec($ch);
curl_close($ch);
?>
```

## API Key Security

### Best Practices

1. **Never expose API keys in client-side code**
   - Always use API keys on your backend server
   - Never commit keys to version control

2. **Use environment variables**
   ```bash
   # .env file
   FETANPAY_API_KEY=fetan_live_sk_abc123...
   ```

3. **Rotate keys regularly**
   - Regenerate keys periodically
   - Revoke old keys immediately if compromised

4. **Use different keys for different environments**
   - Production key for live environment
   - Development key for testing

## Error Responses

### Invalid API Key

```json
{
  "success": false,
  "error": {
    "code": "UNAUTHORIZED",
    "message": "Invalid or missing API key"
  }
}
```

### Revoked API Key

```json
{
  "success": false,
  "error": {
    "code": "API_KEY_REVOKED",
    "message": "This API key has been revoked"
  }
}
```

### Expired API Key

```json
{
  "success": false,
  "error": {
    "code": "API_KEY_EXPIRED",
    "message": "This API key has expired"
  }
}
```

## Managing API Keys

You can manage your API keys through:

1. **Merchant Dashboard**: [https://admin.fetanpay.et/api-keys](https://admin.fetanpay.et/api-keys)
2. **API**: Use the [API Keys Management API](/api/api-keys) endpoints

### Available Operations

- **Create**: Generate a new API key
- **List**: View all your API keys
- **Revoke**: Disable an API key
- **View Details**: See key metadata (name, creation date, last used)

## Next Steps

- Learn how to [verify payments](/api/payments)
- Set up [webhooks](/api/webhooks) for real-time notifications
- Explore the [API reference](/api/reference)
